# Middleware дополнение (wallet-drain hardening)

- Блокируем eth_sign и personal_sign по умолчанию (на фронте не вызывать, в бэкенде валидировать).
- Проверяем origin/host и chainId, навешиваем X-Request-ID.
- Все API принимают только ожидаемые методы (allowlist).

В статическом Netlify нельзя отрубить провайдера MetaMask заголовками. Делается только в приложении: мы никогда не зовём опасные методы, а перед любой отправкой транзы гоняем её через analyzeTx.
